{% extends "@UVDeskSupportCenter/Templates/layout.html.twig" %}

{% block title %}{% trans %}Chatbot FAQ{% endtrans %}{% endblock %}
{% block ogtitle %}{% trans %}Chatbot FAQ{% endtrans %}{% endblock %}
{% block twtitle %}{% trans %}Chatbot FAQ{% endtrans %}{% endblock %}
{% block metaDescription %}{% trans %}Get instant answers to your questions with our AI-powered chatbot{% endtrans %}{% endblock %}
{% block metaKeywords %}{% trans %}chatbot,faq,help,assistant,support{% endtrans %}{% endblock %}

{% block templateCSS %}
<style>
    .chatbot-container {
        max-width: 800px;
        margin: 0 auto;
        padding: 20px;
        background: #fff;
        border-radius: 12px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        min-height: 500px;
    }

    .chatbot-header {
        text-align: center;
        margin-bottom: 30px;
        padding-bottom: 20px;
        border-bottom: 1px solid #f0f0f0;
    }

    .chatbot-header h1 {
        color: #333;
        font-size: 24px;
        font-weight: 500;
        margin: 0;
    }

    .chatbot-header p {
        color: #666;
        margin: 10px 0 0 0;
        font-size: 14px;
    }

    .chat-messages {
        height: 350px;
        overflow-y: auto;
        padding: 15px;
        background: #fafafa;
        border-radius: 8px;
        margin-bottom: 20px;
    }

    .message {
        margin-bottom: 15px;
        display: flex;
        align-items: flex-start;
    }

    .message.bot {
        justify-content: flex-start;
    }

    .message.user {
        justify-content: flex-end;
    }

    .message-content {
        max-width: 70%;
        padding: 12px 16px;
        border-radius: 18px;
        font-size: 14px;
        line-height: 1.4;
    }

    .bot .message-content {
        background: #e8f5e8;
        color: #2c5e2c;
        border-bottom-left-radius: 4px;
    }

    .user .message-content {
        background: #007bff;
        color: white;
        border-bottom-right-radius: 4px;
    }

    .faq-suggestions {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 10px;
        margin-bottom: 20px;
    }

    .faq-btn {
        background: #f8f9fa;
        border: 1px solid #e9ecef;
        border-radius: 6px;
        padding: 10px 15px;
        font-size: 13px;
        color: #495057;
        cursor: pointer;
        transition: all 0.2s ease;
        text-align: left;
    }

    .faq-btn:hover {
        background: #e9ecef;
        border-color: #ced4da;
    }

    .chat-input-container {
        display: flex;
        gap: 10px;
    }

    .chat-input {
        flex: 1;
        padding: 12px 16px;
        border: 1px solid #ddd;
        border-radius: 6px;
        font-size: 14px;
        outline: none;
        transition: border-color 0.2s ease;
    }

    .chat-input:focus {
        border-color: #007bff;
        box-shadow: 0 0 0 2px rgba(0,123,255,0.25);
    }

    .send-btn {
        padding: 12px 20px;
        background: #007bff;
        color: white;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        font-size: 14px;
        transition: background 0.2s ease;
    }

    .send-btn:hover {
        background: #0056b3;
    }

    .send-btn:disabled {
        background: #ccc;
        cursor: not-allowed;
    }

    .typing-indicator {
        display: none;
        padding: 8px 16px;
        background: #e8f5e8;
        border-radius: 18px;
        color: #2c5e2c;
        font-size: 14px;
        margin-bottom: 15px;
    }

    .typing-indicator span {
        animation: typing 1.4s infinite;
    }

    .typing-indicator span:nth-child(2) {
        animation-delay: 0.2s;
    }

    .typing-indicator span:nth-child(3) {
        animation-delay: 0.4s;
    }

    @keyframes typing {
        0%, 60%, 100% { opacity: 0.3; }
        30% { opacity: 1; }
    }

    @media (max-width: 768px) {
        .chatbot-container {
            margin: 10px;
            padding: 15px;
        }
        
        .message-content {
            max-width: 85%;
        }
        
        .faq-suggestions {
            grid-template-columns: 1fr;
        }
    }
</style>
{% endblock %}

{% block body %}
<div class="chatbot-container">
    <div class="chatbot-header">
        <h1>{% trans %}FAQ Chatbot{% endtrans %}</h1>
        <p>{% trans %}Ask me anything about our products and services{% endtrans %}</p>
    </div>

    <div class="chat-messages" id="chatMessages">
        <div class="message bot">
            <div class="message-content">
                {% trans %}Hello! I'm here to help you. What would you like to know?{% endtrans %}
            </div>
        </div>
    </div>

    <div class="faq-suggestions">
        <button class="faq-btn" data-question="{% trans %}How do I reset my password?{% endtrans %}">
            {% trans %}How do I reset my password?{% endtrans %}
        </button>
        <button class="faq-btn" data-question="{% trans %}What are your business hours?{% endtrans %}">
            {% trans %}What are your business hours?{% endtrans %}
        </button>
        <button class="faq-btn" data-question="{% trans %}How can I contact support?{% endtrans %}">
            {% trans %}How can I contact support?{% endtrans %}
        </button>
        <button class="faq-btn" data-question="{% trans %}Where can I find documentation?{% endtrans %}">
            {% trans %}Where can I find documentation?{% endtrans %}
        </button>
    </div>

    <div class="typing-indicator" id="typingIndicator">
        <span>●</span><span>●</span><span>●</span>
    </div>

    <div class="chat-input-container">
        <input type="text" class="chat-input" id="chatInput" placeholder="{% trans %}Type your question here...{% endtrans %}" autocomplete="off">
        <button class="send-btn" id="sendBtn">{% trans %}Send{% endtrans %}</button>
    </div>
</div>
{% endblock %}

{% block footer %}
{{ parent() }}

<script type="text/javascript">
$(function() {
    const chatMessages = $('#chatMessages');
    const chatInput = $('#chatInput');
    const sendBtn = $('#sendBtn');
    const typingIndicator = $('#typingIndicator');
    const faqButtons = $('.faq-btn');

    // Sample FAQ responses
    const faqResponses = {
        '{% trans %}How do I reset my password?{% endtrans %}': '{% trans %}You can reset your password by clicking on "Forgot Password" on the login page. We\'ll send a reset link to your email address.{% endtrans %}',
        '{% trans %}What are your business hours?{% endtrans %}': '{% trans %}Our support team is available Monday to Friday from 9 AM to 6 PM EST. Emergency support is available 24/7 for critical issues.{% endtrans %}',
        '{% trans %}How can I contact support?{% endtrans %}': '{% trans %}You can contact support by creating a ticket through our helpdesk system, emailing support@company.com, or calling our hotline at 1-800-HELP-NOW.{% endtrans %}',
        '{% trans %}Where can I find documentation?{% endtrans %}': '{% trans %}Our documentation is available in the Knowledgebase section. You can browse articles by category or use the search function to find specific topics.{% endtrans %}'
    };

    // Default response for unknown questions
    const defaultResponse = '{% trans %}I\'m not sure about that. Please try asking something else or contact our support team for assistance.{% endtrans %}';

    // Add message to chat
    function addMessage(text, isUser = false) {
        const messageClass = isUser ? 'user' : 'bot';
        const messageHtml = `
            <div class="message ${messageClass}">
                <div class="message-content">${text}</div>
            </div>
        `;
        chatMessages.append(messageHtml);
        chatMessages.scrollTop(chatMessages[0].scrollHeight);
    }

    // Show typing indicator
    function showTyping() {
        typingIndicator.show();
        chatMessages.scrollTop(chatMessages[0].scrollHeight);
    }

    // Hide typing indicator
    function hideTyping() {
        typingIndicator.hide();
    }

    // Get bot response
    function getBotResponse(question) {
        // Simple keyword matching for demo purposes
        const lowerQuestion = question.toLowerCase();
        
        if (lowerQuestion.includes('password') || lowerQuestion.includes('reset')) {
            return faqResponses['{% trans %}How do I reset my password?{% endtrans %}'];
        } else if (lowerQuestion.includes('hour') || lowerQuestion.includes('time') || lowerQuestion.includes('business')) {
            return faqResponses['{% trans %}What are your business hours?{% endtrans %}'];
        } else if (lowerQuestion.includes('contact') || lowerQuestion.includes('support') || lowerQuestion.includes('help')) {
            return faqResponses['{% trans %}How can I contact support?{% endtrans %}'];
        } else if (lowerQuestion.includes('document') || lowerQuestion.includes('guide') || lowerQuestion.includes('manual')) {
            return faqResponses['{% trans %}Where can I find documentation?{% endtrans %}'];
        } else {
            return defaultResponse;
        }
    }

    // Send message
    function sendMessage() {
        const message = chatInput.val().trim();
        if (!message) return;

        // Add user message
        addMessage(message, true);
        chatInput.val('');
        
        // Show typing indicator
        showTyping();
        
        // Simulate bot thinking
        setTimeout(() => {
            hideTyping();
            const response = getBotResponse(message);
            addMessage(response);
        }, 1000 + Math.random() * 1000); // Random delay between 1-2 seconds
    }

    // Event listeners
    sendBtn.on('click', sendMessage);
    
    chatInput.on('keypress', function(e) {
        if (e.which === 13) { // Enter key
            sendMessage();
        }
    });

    // FAQ button clicks
    faqButtons.on('click', function() {
        const question = $(this).data('question');
        chatInput.val(question);
        sendMessage();
    });

    // Focus input on load
    chatInput.focus();
});
</script>
{% endblock %}
